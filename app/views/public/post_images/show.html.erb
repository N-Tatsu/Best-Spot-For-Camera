<div class="container">
    <h2 class="text-center p-5"><i class="fa-solid fa-camera"></i>投稿詳細情報</h2>
    <% flash.each do |message_type, message| %>
        <div class="flash-message" <%= message_type %>><%= message %></div>
    <% end %>

    <div class="row">
        <div class="col-6 mb-5">
            <div class="mb-3">
              <%= image_tag @post_image.user.get_profile_image(50,50) %>
              <%= link_to @post_image.user.name, user_path(@post_image.user_id) %>
            </div>
            <div class="mb-3">
                <%= image_tag @post_image.image, size: "470x310" %>
            </div>
            <!--いいねボタン-->
            <div>
                <span>
                    <% if @post_image.favorited_by?(current_user) %>
                        <%= link_to post_image_favorite_path(@post_image), method: :delete do %>
                            <i class="fas fa-heart" aria-hidden="true" style="color: red;"></i>×
                            <%= @post_image.favorites.count %> いいね
                        <% end %>
                    <% else %>
                        <%= link_to post_image_favorite_path(@post_image), method: :post do %>
                            ♡×<%= @post_image.favorites.count %> いいね
                        <% end %>
                    <% end %>
                    <!--コメント数-->
                    <span>コメント件数:<%= @post_image.post_comments.count %></span>
                </span>
                    <% if @post_image.user_id == current_user.id %>
                        <span><%= link_to "編集する", edit_post_image_path, class:"btn btn-primary" %></span>
                        <span><%= link_to "削除する", post_image_path(@post_image), method: :delete, data: {confirm: "本当に削除しますか？"}, class:"btn btn-danger" %></span>
                    <% end %>
                <div class="mt-3 mb-3"><%= @post_image.body %></div>
                <!--タグリスト-->
                <div class="mb-3">
                    <% @post_image.tags.each do |tag| %>
                        <i class="fa-sharp fa-solid fa-tag"></i>
                        <%= link_to tag.name, search_tag_path(tag_id: tag.id) %>
                    <% end %>
                </div>
                <span><i class="fa-solid fa-location-dot"></i><%= @post_image.address %></span>
            </div>
        </div>

        <div class="col-5">
　          <!--コメント一覧-->
　          <% @post_image.post_comments.each do |post_comment| %>
            <div class="mb-3">
                <span class="d-flex">
                    <%= image_tag post_comment.user.get_profile_image(50,50) %></p>
                    <%= post_comment.user.name %>
                </span>
                <span>
                    <%= post_comment.comment %>
                    <%= post_comment.created_at.strftime('%Y/%m/%d') %>
                    <% if post_comment.user == current_user %>
                        <%= link_to "削除する", post_image_post_comment_path(post_comment.post_image, post_comment), method: :delete, data: { confirm: "削除してもよろしいですか？" }, class:"btn btn-danger" %>
                    <% end %>
                </span>
            </div>
            <% end %>
            <!--コメントフォーム-->
            <div>
                <%= form_with model: [@post_image,@post_comment] do |f| %>
                    <div class="input-group">
                       <div class="input-group-prepend">
                          <span class="input-group-text" aria-hidden="true"><i class="fa-solid fa-pen"></i></span>
                       </div>
                       <%= f.text_area :comment, row: '5', placeholder: "コメント欄", required: true %>
                    </div>
                    <%= f.submit "コメント保存" %>
                <% end %>
            </div>
        </div>
    </div>

    <div class="container">
      <div id="map"></div>
    </div>
</disv>
<%= javascript_pack_tag 'map', 'data-turbolinks-track': 'reload' %>